#!/bin/sh

# Toggle dropdown terminal windows in River.
# The first argument is the name of the dropdown window.
# The rest is the command to be run inside the terminal.

namemsg="$1"
classmsg="dropdown"
titlemsg="dropdown_$namemsg"
shift

# Get the window ID of an existing dropdown terminal
existing=$(riverctl list-views | awk -v class="$classmsg" '$3 == class {print $1}')

if [ -n "$existing" ]; then
    # If found, close it
    riverctl close-view "$existing"
else
    # Otherwise, launch a new one
    case "$TERMINAL" in
    *alacritty)
        class="--class $classmsg"
        title="--title $titlemsg"
        cmd="--command $@"
        ;;
    *foot)
        class="-a $classmsg"
        title="--title $titlemsg"
        cmd="-e $@"
        ;;
    *ghostty)
        class="--class=$classmsg"
        title="--title=$titlemsg"
        cmd="--initial-command=$@"
        ;;
    esac

    $TERMINAL "$class"  "$title"  "$cmd" &
fi
